(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7753:function(e,t,a){Promise.resolve().then(a.bind(a,452)),Promise.resolve().then(a.bind(a,8473)),Promise.resolve().then(a.t.bind(a,2853,23))},452:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return NavBar}});var n=a(7437),l=a(1396),r=a.n(l),s=a(2265),o=a(9245),i=a(635);function AuthModalInputs(e){let{inputs:t,handleChangeInput:a,isSignin:l}=e;return(0,n.jsxs)("div",{className:"",children:[l?null:(0,n.jsxs)("div",{className:"my-3 flex justify-between text-sm  ",children:[(0,n.jsx)("input",{type:"text",className:"border rounded p-2 py-3 w-[49%] bg-white text-black",placeholder:"First Name",value:t.firstName,onChange:a,name:"firstName"}),(0,n.jsx)("input",{type:"text",className:"border rounded p-2 py-3 w-[49%] bg-white text-black",placeholder:"Last Name",value:t.lastName,onChange:a,name:"lastName"})]}),(0,n.jsx)("div",{className:"my-3 flex justify-between text-sm",children:(0,n.jsx)("input",{type:"text",className:"border rounded p-2 py-3 w-full bg-white text-black",placeholder:"Email",value:t.email,onChange:a,name:"email"})}),l?null:(0,n.jsxs)("div",{className:"my-3 flex justify-between text-sm",children:[(0,n.jsx)("input",{type:"text",className:"border rounded p-2 py-3 w-[49%] bg-white text-black",placeholder:"Phone",value:t.phone,onChange:a,name:"phone"}),(0,n.jsx)("input",{type:"text",className:"border rounded p-2 py-3 w-[49%] bg-white text-black",placeholder:"City",value:t.city,onChange:a,name:"city"})]}),(0,n.jsx)("div",{className:"my-3 flex justify-between text-sm",children:(0,n.jsx)("input",{type:"text",className:"border rounded p-2 py-3 w-full bg-white text-black",placeholder:"Password",value:t.password,onChange:a,name:"password"})})]})}var d=a(2173),u=a(7713),c=a(8473),hooks_useAuth=()=>{let{data:e,error:t,loading:a,setAuthState:n}=(0,s.useContext)(c.AuthenticationContext),signin=async(e,t)=>{let{email:a,password:l}=e;n({data:null,error:null,loading:!0});try{let e=await d.Z.post("http://localhost:3000/api/auth/signin",{email:a,password:l});console.log(e),n({data:e.data,error:null,loading:!1}),t()}catch(e){n({data:null,error:e.response.data.errorMessage,loading:!1})}},signup=async(e,t)=>{let{email:a,password:l,firstName:r,lastName:s,phone:o,city:i}=e;n({data:null,error:null,loading:!0});try{let e=await d.Z.post("http://localhost:3000/api/auth/signup",{email:a,password:l,firstName:r,lastName:s,phone:o,city:i});console.log(e),n({data:e.data,error:null,loading:!1}),t()}catch(e){n({data:null,error:e.response.data.errorMessage,loading:!1})}};return{signin,signup,signout:()=>{(0,u.deleteCookie)("jwt"),n({data:null,error:null,loading:!1})}}},h=a(6882),p=a(1314);let x={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:4};function AuthModal(e){let{isSignin:t}=e,[a,l]=(0,s.useState)(!1),handleClose=()=>l(!1),{signin:r,signup:d}=hooks_useAuth(),{loading:u,data:m,error:b}=(0,s.useContext)(c.AuthenticationContext),renderContent=(e,a)=>t?e:a,[g,f]=(0,s.useState)({firstName:"",lastName:"",email:"",phone:"",city:"",password:""}),[j,N]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{if(t){if(g.password&&g.email)return N(!1)}else if(g.firstName&&g.lastName&&g.email&&g.password&&g.password&&g.city)return N(!1);N(!0)},[g]),(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{className:"".concat(renderContent("bg-blue-500 hover:bg-blue-400 text-white","hover:bg-gray-100")," border p-1 px-4 rounded mr-3"),onClick:()=>l(!0),children:renderContent("Sign in","Sign up")}),(0,n.jsx)(i.Z,{open:a,onClose:handleClose,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,n.jsx)(o.Z,{sx:x,children:u?(0,n.jsx)("div",{className:"py-24 px-2 h-[600px] flex justify-center",children:(0,n.jsx)(h.Z,{})}):(0,n.jsxs)("div",{className:"p-2 h-[600px]",children:[b?(0,n.jsx)(p.Z,{severity:"error",className:"mb-4",children:b}):null,(0,n.jsxs)("div",{className:"uppercase font-bold text-center pb-2 border-b mb-2",children:[(0,n.jsx)("p",{className:"text-sm text-black",children:renderContent("Sign in","Create Account")}),(0,n.jsxs)("p",{className:"text-black",children:[null==m?void 0:m.firstName," ",null==m?void 0:m.lastName]})]}),(0,n.jsxs)("div",{className:"m-auto",children:[(0,n.jsx)("h2",{className:"text-2xl font-light text-center text-black",children:renderContent("Log Into Your Account","Create Your OpenTable Account")}),(0,n.jsx)(AuthModalInputs,{inputs:g,handleChangeInput:e=>{f({...g,[e.target.name]:e.target.value})},isSignin:t}),(0,n.jsx)("button",{className:"uppercase bg-red-600 w-full text-white p-3 rounded text-sm mb-5 disabled:bg-gray-400",disabled:j,onClick:()=>{t?r({email:g.email,password:g.password},handleClose):d(g,handleClose)},children:renderContent("Sign in","Create Account")})]})]})})})]})}function NavBar(){let{data:e,loading:t}=(0,s.useContext)(c.AuthenticationContext),{signout:a}=hooks_useAuth();return(0,n.jsxs)("nav",{className:"bg-white p-2 flex justify-between",children:[(0,n.jsx)(r(),{href:"",className:"font-bold text-gray-700 text-2xl",children:"OpenTable"}),(0,n.jsx)("div",{children:t?null:(0,n.jsx)("div",{className:"flex",children:e?(0,n.jsx)("button",{className:"bg-blue-500 hover:bg-blue-400 text-white border p-1 px-4 rounded mr-3",onClick:a,children:"Sign out"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(AuthModal,{isSignin:!0}),(0,n.jsx)(AuthModal,{isSignin:!1})]})})})]})}},8473:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthenticationContext:function(){return o},default:function(){return AuthContext}});var n=a(7437),l=a(2173),r=a(7713),s=a(2265);let o=(0,s.createContext)({loading:!1,error:null,data:null,setAuthState:()=>{}});function AuthContext(e){let{children:t}=e,[a,i]=(0,s.useState)({loading:!0,data:null,error:null}),fetchUser=async()=>{i({data:null,error:null,loading:!0});try{let e=(0,r.getCookie)("jwt");if(!e)return i({data:null,error:null,loading:!1});let t=await l.Z.get("http://localhost:3000/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});l.Z.defaults.headers.common.Authorization="Bearer ".concat(e),i({data:t.data,error:null,loading:!1})}catch(e){i({data:null,error:e.response.data.errorMessage,loading:!1})}};return(0,s.useEffect)(()=>{fetchUser()},[]),(0,n.jsx)(o.Provider,{value:{...a,setAuthState:i},children:t})}},2853:function(){}},function(e){e.O(0,[326,330,971,472,744],function(){return e(e.s=7753)}),_N_E=e.O()}]);