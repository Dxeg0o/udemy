"use strict";(()=>{var e={};e.id=605,e.ids=[605],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,Z)=>{Object.defineProperty(Z,"l",{enumerable:!0,get:function(){return function e(Z,i){return i in Z?Z[i]:"then"in Z&&"function"==typeof Z.then?Z.then(Z=>e(Z,i)):"function"==typeof Z&&"default"===i?Z:void 0}}})},2980:(e,Z,i)=>{i.r(Z),i.d(Z,{config:()=>p,default:()=>n,routeModule:()=>c});var s={};i.r(s),i.d(s,{default:()=>d});var a=i(1802),m=i(7153),t=i(6249),r=i(3524);let T=[{displayTime:"12:00 AM",time:"00:00:00.000Z",searchTimes:["00:00:00.000Z","00:30:00.000Z","01:00:00.000Z"]},{displayTime:"12:30 AM",time:"00:30:00.000Z",searchTimes:["00:00:00.000Z","00:30:00.000Z","01:00:00.000Z","01:30:00.000Z"]},{displayTime:"1:00 AM",time:"01:00:00.000Z",searchTimes:["00:00:00.000Z","00:30:00.000Z","01:00:00.000Z","01:30:00.000Z","02:00:00.000Z"]},{displayTime:"1:30 AM",time:"01:30:00.000Z",searchTimes:["00:30:00.000Z","01:00:00.000Z","01:30:00.000Z","02:00:00.000Z","02:30:00.000Z"]},{displayTime:"2:00 AM",time:"02:00:00.000Z",searchTimes:["01:00:00.000Z","01:30:00.000Z","02:00:00.000Z","02:30:00.000Z","03:00:00.000Z"]},{displayTime:"2:30 AM",time:"02:30:00.000Z",searchTimes:["01:30:00.000Z","02:00:00.000Z","02:30:00.000Z","03:00:00.000Z","03:30:00.000Z"]},{displayTime:"3:00 AM",time:"03:00:00.000Z",searchTimes:["02:00:00.000Z","02:30:00.000Z","03:00:00.000Z","03:30:00.000Z","04:00:00.000Z"]},{displayTime:"3:30 AM",time:"03:30:00.000Z",searchTimes:["02:30:00.000Z","03:00:00.000Z","03:30:00.000Z","04:00:00.000Z","04:30:00.000Z"]},{displayTime:"4:00 AM",time:"04:00:00.000Z",searchTimes:["03:00:00.000Z","03:30:00.000Z","04:00:00.000Z","04:30:00.000Z","05:00:00.000Z"]},{displayTime:"4:30 AM",time:"04:30:00.000Z",searchTimes:["03:30:00.000Z","04:00:00.000Z","04:30:00.000Z","05:00:00.000Z","05:30:00.000Z"]},{displayTime:"5:00 AM",time:"05:00:00.000Z",searchTimes:["04:00:00.000Z","04:30:00.000Z","05:00:00.000Z","05:30:00.000Z","06:00:00.000Z"]},{displayTime:"5:30 AM",time:"05:30:00.000Z",searchTimes:["04:30:00.000Z","05:00:00.000Z","05:30:00.000Z","06:00:00.000Z","06:30:00.000Z"]},{displayTime:"6:00 AM",time:"06:00:00.000Z",searchTimes:["05:00:00.000Z","05:30:00.000Z","06:00:00.000Z","06:30:00.000Z","07:00:00.000Z"]},{displayTime:"6:30 AM",time:"06:30:00.000Z",searchTimes:["05:30:00.000Z","06:00:00.000Z","06:30:00.000Z","07:00:00.000Z","07:30:00.000Z"]},{displayTime:"7:00 AM",time:"07:00:00.000Z",searchTimes:["06:00:00.000Z","06:30:00.000Z","07:00:00.000Z","07:30:00.000Z","08:00:00.000Z"]},{displayTime:"7:30 AM",time:"07:30:00.000Z",searchTimes:["06:30:00.000Z","07:00:00.000Z","07:30:00.000Z","08:00:00.000Z","08:30:00.000Z"]},{displayTime:"8:00 AM",time:"08:00:00.000Z",searchTimes:["07:00:00.000Z","07:30:00.000Z","08:00:00.000Z","08:30:00.000Z","09:00:00.000Z"]},{displayTime:"8:30 AM",time:"08:30:00.000Z",searchTimes:["07:30:00.000Z","08:00:00.000Z","08:30:00.000Z","09:00:00.000Z","09:30:00.000Z"]},{displayTime:"9:00 AM",time:"09:00:00.000Z",searchTimes:["08:00:00.000Z","08:30:00.000Z","09:00:00.000Z","09:30:00.000Z","10:00:00.000Z"]},{displayTime:"9:30 AM",time:"09:30:00.000Z",searchTimes:["08:30:00.000Z","09:00:00.000Z","09:30:00.000Z","10:00:00.000Z","10:30:00.000Z"]},{displayTime:"10:00 AM",time:"10:00:00.000Z",searchTimes:["09:00:00.000Z","09:30:00.000Z","10:00:00.000Z","10:30:00.000Z","11:00:00.000Z"]},{displayTime:"10:30 AM",time:"10:30:00.000Z",searchTimes:["09:30:00.000Z","10:00:00.000Z","10:30:00.000Z","11:00:00.000Z","11:30:00.000Z"]},{displayTime:"11:00 AM",time:"11:00:00.000Z",searchTimes:["10:00:00.000Z","10:30:00.000Z","11:00:00.000Z","11:30:00.000Z","12:00:00.000Z"]},{displayTime:"11:30 AM",time:"11:30:00.000Z",searchTimes:["10:30:00.000Z","11:00:00.000Z","11:30:00.000Z","12:00:00.000Z","12:30:00.000Z"]},{displayTime:"12:00 PM",time:"12:00:00.000Z",searchTimes:["11:00:00.000Z","11:30:00.000Z","12:00:00.000Z","12:30:00.000Z","13:00:00.000Z"]},{displayTime:"12:30 PM",time:"12:30:00.000Z",searchTimes:["11:30:00.000Z","12:00:00.000Z","12:30:00.000Z","13:00:00.000Z","13:30:00.000Z"]},{displayTime:"1:00 PM",time:"13:00:00.000Z",searchTimes:["12:00:00.000Z","12:30:00.000Z","13:00:00.000Z","13:30:00.000Z","14:00:00.000Z"]},{displayTime:"1:30 PM",time:"13:30:00.000Z",searchTimes:["12:30:00.000Z","13:00:00.000Z","13:30:00.000Z","14:00:00.000Z","14:30:00.000Z"]},{displayTime:"2:00 PM",time:"14:00:00.000Z",searchTimes:["13:00:00.000Z","13:30:00.000Z","14:00:00.000Z","14:30:00.000Z","15:00:00.000Z"]},{displayTime:"2:30 PM",time:"14:30:00.000Z",searchTimes:["13:30:00.000Z","14:00:00.000Z","14:30:00.000Z","15:00:00.000Z","15:30:00.000Z"]},{displayTime:"3:00 PM",time:"15:00:00.000Z",searchTimes:["14:00:00.000Z","14:30:00.000Z","15:00:00.000Z","15:30:00.000Z","16:00:00.000Z"]},{displayTime:"3:30 PM",time:"15:30:00.000Z",searchTimes:["14:30:00.000Z","15:00:00.000Z","15:30:00.000Z","16:00:00.000Z","16:30:00.000Z"]},{displayTime:"4:00 PM",time:"16:00:00.000Z",searchTimes:["15:00:00.000Z","15:30:00.000Z","16:00:00.000Z","16:30:00.000Z","17:00:00.000Z"]},{displayTime:"4:30 PM",time:"16:30:00.000Z",searchTimes:["15:30:00.000Z","16:00:00.000Z","16:30:00.000Z","17:00:00.000Z","17:30:00.000Z"]},{displayTime:"5:00 PM",time:"17:00:00.000Z",searchTimes:["16:00:00.000Z","16:30:00.000Z","17:00:00.000Z","17:30:00.000Z","18:00:00.000Z"]},{displayTime:"5:30 PM",time:"17:30:00.000Z",searchTimes:["16:30:00.000Z","17:00:00.000Z","17:30:00.000Z","18:00:00.000Z","18:30:00.000Z"]},{displayTime:"6:00 PM",time:"18:00:00.000Z",searchTimes:["17:00:00.000Z","17:30:00.000Z","18:00:00.000Z","18:30:00.000Z","19:00:00.000Z"]},{displayTime:"6:30 PM",time:"18:30:00.000Z",searchTimes:["17:30:00.000Z","18:00:00.000Z","18:30:00.000Z","19:00:00.000Z","19:30:00.000Z"]},{displayTime:"7:00 PM",time:"19:00:00.000Z",searchTimes:["18:00:00.000Z","18:30:00.000Z","19:00:00.000Z","19:30:00.000Z","20:00:00.000Z"]},{displayTime:"7:30 PM",time:"19:30:00.000Z",searchTimes:["18:30:00.000Z","19:00:00.000Z","19:30:00.000Z","20:00:00.000Z","20:30:00.000Z"]},{displayTime:"8:00 PM",time:"20:00:00.000Z",searchTimes:["19:00:00.000Z","19:30:00.000Z","20:00:00.000Z","20:30:00.000Z","21:00:00.000Z"]},{displayTime:"8:30 PM",time:"20:30:00.000Z",searchTimes:["19:30:00.000Z","20:00:00.000Z","20:30:00.000Z","21:00:00.000Z","21:30:00.000Z"]},{displayTime:"9:00 PM",time:"21:00:00.000Z",searchTimes:["20:00:00.000Z","20:30:00.000Z","21:00:00.000Z","21:30:00.000Z","22:00:00.000Z"]},{displayTime:"9:30 PM",time:"21:30:00.000Z",searchTimes:["20:30:00.000Z","21:00:00.000Z","21:30:00.000Z","22:00:00.000Z","22:30:00.000Z"]},{displayTime:"10:00 PM",time:"22:00:00.000Z",searchTimes:["21:00:00.000Z","21:30:00.000Z","22:00:00.000Z","22:30:00.000Z","23:00:00.000Z"]},{displayTime:"10:30 PM",time:"22:30:00.000Z",searchTimes:["21:30:00.000Z","22:00:00.000Z","22:30:00.000Z","23:00:00.000Z","23:30:00.000Z"]},{displayTime:"11:00 PM",time:"23:00:00.000Z",searchTimes:["22:00:00.000Z","22:30:00.000Z","23:00:00.000Z","23:30:00.000Z"]},{displayTime:"11:30 PM",time:"23:30:00.000Z",searchTimes:["22:30:00.000Z","23:00:00.000Z","23:30:00.000Z"]}],l=new r.PrismaClient;async function d(e,Z){let{slug:i,day:s,time:a,partySize:m}=e.query;if(!s||!a||!m)return Z.status(400).json({errorMessage:"Invalid data provideasdd"});let t=T.find(e=>e.time===a)?.searchTimes;if(!t)return Z.status(400).json({errorMessage:"Invalid data provideddd"});let r=await l.booking.findMany({where:{booking_time:{gte:new Date(`${s}T${t[0]}`),lte:new Date(`${s}T${t[t.length-1]}`)}},select:{number_of_people:!0,booking_time:!0,tables:!0}}),d={};r.forEach(e=>{d[e.booking_time.toISOString()]=e.tables.reduce((e,Z)=>({...e,[Z.table_id]:!0}),{})});let n=await l.restaurant.findUnique({where:{slug:i},select:{tables:!0,open_time:!0,close_time:!0}});if(!n)return Z.status(400).json({errorMessage:"Invalid data provideddd"});let p=n.tables,c=t.map(e=>({date:new Date(`${s}T${e}`),time:e,tables:p}));c.forEach(e=>{e.tables=e.tables.filter(Z=>!d[e.date.toISOString()]||!d[e.date.toISOString()][Z.id])});let h=c.map(e=>{let Z=e.tables.reduce((e,Z)=>e+Z.seats,0);return{time:e.time,available:Z>=parseInt(m)}}).filter(e=>{let Z=new Date(`${s}T${e.time}`)>=new Date(`${s}T${n.open_time}`),i=new Date(`${s}T${e.time}`)<=new Date(`${s}T${n.close_time}`);return Z&&i});return Z.json({availabilities:h})}let n=(0,t.l)(s,"default"),p=(0,t.l)(s,"config"),c=new a.PagesAPIRouteModule({definition:{kind:m.x.PAGES_API,page:"/api/restaurant/[slug]/availability",pathname:"/api/restaurant/[slug]/availability",bundlePath:"",filename:""},userland:s})},7153:(e,Z)=>{var i;Object.defineProperty(Z,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},1802:(e,Z,i)=>{e.exports=i(145)}};var Z=require("../../../../webpack-api-runtime.js");Z.C(e);var i=Z(Z.s=2980);module.exports=i})();